<script>

function scroll_down()
{
  $("html, body").animate({ scrollTop: $(document).height() }, 'slow');
  //$("html, body").animate({ scrollTop: $(document).height() }, 200);
}

function scroll_up()
{
  $("html, body").animate({ scrollTop: 0 }, 'slow');
  //$("html, body").animate({ scrollTop: $(document).height() }, 200);
}

$(window).load(function() {
  scroll_down();
});


</script>

<p id="notice"><%= notice %></p>

<h1>Listing Tasks</h1>

<%= render :partial=>"kiroku_link" %>


<% @days_tasks.each do |tasks| %>
  <%= tasks[0].start.strftime("%Y/%m/%d(#{%w(日 月 火 水 木 金 土)[tasks[0].start.wday]})")%>

  <table class="task_data">
    <thead>
      <tr>
        <th class="start">Start</th>
        <th class="end">End</th>
        <th class="dur">Dur</th>
        <th class="body">Body</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% tasks.each do |task| %>
        <% if task.show_flg == true %>
          <tr class="<%= task.start.hour.even? ? "even_hour":"odd_hour"%>">
            <td><%= task.start.strftime "%H:%M" %></td>
            <td><%= task.end.strftime " %H:%M" %></td>
            <!--<td><%#= (task.dur).utc.strftime "%H:%M:%S" unless task.dur.nil? %></td>-->
            <td><%= (Time.at task.end-task.start).utc.strftime "%H:%M:%S"%></td>
            <td><pre><%= task.body %></pre></td>
            <td><%= link_to  task do %><i class="glyphicon glyphicon-eye-open"></i><% end %></td>
            <td><%= link_to  edit_task_path(task) do %><i class="glyphicon glyphicon-pencil"></i><% end %></td>
            <td><%= link_to  task, method: :delete, data: { confirm: 'Are you sure?' } do %><i class="glyphicon glyphicon-trash"><% end %></i></td>
          </tr>
        <% end %>
      <% end %>
    </tbody>
  </table>
  </br>
<% end %>
<br>

<div style="width: 600px">
  <p id="notice"><%= notice %></p>

  <h2 class="entry_title">＜記録する内容＞</h2>

  <% @task = Task.new %>

  <%= form_for(@task) do |f| %>
    <% if @task.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(@task.errors.count, "error") %> prohibited this task from being saved:</h2>

        <ul>
        <% @task.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
        </ul>
      </div>
    <% end %>

    <div class="field" style="display:none">
      <%= f.label :start %><br>
      <%= f.datetime_select :start,:include_seconds => true, :order => [:month, :day, :year, :hour, :minute, :second] %>
    </div>

    <div class="field">
      <div class="txt_cont">
        <%= f.text_area :body, size:"x10"  %>
      </div>
    </div>
    <div class="actions" style="text-align: right">
      <%= f.submit "記録"  %>
    </div>
  <% end %>

</div>